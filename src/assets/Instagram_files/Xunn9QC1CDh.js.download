;/*FB_PKG_DELIM*/

__d("LSAddToMemberCount",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.db.table(9).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?0:(e=d.item,b.sequence([function(d){return c[2]=e.memberCount,b.i64.neq(c[2],void 0)?b.resolve(c[0]=c[2]):b.sequence([function(d){return b.count(b.db.table(14).fetch([[[a[0]]]])).then(function(a){return c[3]=a})},function(a){return c[0]=c[3]}])},function(d){return c[1]=b.i64.add(c[0],a[1]),b.forEach(b.db.table(9).fetch([[[e.threadKey]]]),function(a){var d=a.update;a.item;return d({memberCount:b.i64.gt(c[1],b.i64.cast([0,0]))?c[1]:b.i64.cast([0,0])})})}]))})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxAddToMemberCountStoredProcedure";a.__tables__=["threads","participants"];e.exports=a}),null);
__d("LSClearLocalThreadPictureUrl",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return function(a){b.logger(a).info(a)}("clearLocalThreadPictureUrl"),b.forEach(b.filter(b.db.table(9).fetch([[[a[0]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&!c.isCustomThreadPicture&&(b.i64.eq(c.threadType,b.i64.cast([0,2]))||b.i64.eq(c.threadType,b.i64.cast([0,5])))&&c.threadPictureUrl!==void 0&&b.like(c.threadPictureUrl,"file:%")}),function(a){var b=a.update;a.item;return b({threadPictureUrl:void 0})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxClearLocalThreadPictureUrlStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSDeleteRtcRoomOnThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(181).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteRtcRoomOnThreadStoredProcedure";a.__tables__=["rtc_rooms_on_threads"];e.exports=a}),null);
__d("LSRemoveFromAdminApprovalQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(26).fetch([[[a[0],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.contactId,a[1])}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxRemoveFromAdminApprovalQueueStoredProcedure";a.__tables__=["group_membership_approval_requests"];e.exports=a}),null);
__d("LSRemoveParticipantFromThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(14).fetch([[[a[0],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.contactId,a[1])}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxRemoveParticipantFromThreadStoredProcedure";a.__tables__=["participants"];e.exports=a}),null);
__d("LSSetThreadCannotUnsendReason",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({cannotUnsendReason:a[1]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxSetThreadCannotUnsendReasonStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSUpdateInviterId",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({inviterId:a[1]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateInviterIdStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSUpdateParticipantCapabilities",["LSComputeParticipantCapabilities"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSComputeParticipantCapabilities"),a[0],a[1]).then(function(a){return a=a,d[0]=a[0],a})},function(b){return c.forEach(c.filter(c.db.table(14).fetch([[[a[1],a[0]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,a[0])}),function(a){var b=a.update;a.item;return b({participantCapabilities:d[0]})})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxUpdateParticipantCapabilitiesStoredProcedure";a.__tables__=["participants"];e.exports=a}),null);
__d("LSUpdateParticipantSubscribeSourceText",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(14).fetch([[[a[0],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.contactId,a[1])}),function(b){var c=b.update;b.item;return c({subscribeSource:a[2]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateParticipantSubscribeSourceTextStoredProcedure";a.__tables__=["participants"];e.exports=a}),null);
__d("LSUpdateThreadParticipantAdminStatus",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(14).fetch([[[a[0],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.contactId,a[1])}),function(b){var c=b.update;b.item;return c({isAdmin:a[2]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateThreadParticipantAdminStatusStoredProcedure";a.__tables__=["participants"];e.exports=a}),null);